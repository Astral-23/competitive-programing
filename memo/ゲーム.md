# 考察のコツ
一般化しない
- 特に : xor について、 xor = 0 or notだけが気になる
    - 一般にxorが変化するか、はどうでも良くて、たいてい「xor = 0 だった時、操作を変更することで xor != 0にできるか」しか気にならない

- ゲームも、「自由度が高い中で最適を考える」の枠組みに当てはまる
    - つまり、普遍量による議論が有効
    - [例題](https://atcoder.jp/contests/arc137/tasks/arc137_c)
    
<br><br>

# 考察

- 結果を決定する値を考察(勝つ ⇔ ある値がooの形に条件を言い換える)
    - したら、その値を考察
    - 2人ゲームなら大抵偶奇
- ラストの操作・最初の操作に注目
    - > 命題: 任意に状況を変更するような操作ができる時、最後にその操作をした方が勝つ
    
- 何かを固定した時の勝敗や戦略を考える
    - 複雑な物を固定すれば、貪欲が生まれて操作が一意になったり...

- プレイヤーができる、綺麗な事実に注目
    - 構築でいう、「綺麗な事」に相当
    - ゲームも、自由度が高い場合が多いので、似た方針が役立つ
    - これを用いて必勝法を編みだせないか？
        - 猿真似戦術
        - 偏らせる

- ゲームの勝敗を決める、簡単な要素に注目
    - 極端なケースでは勝敗が決まって胃がち
        - 極端なケースとは？
        - 極端でないケースでできることとは?

> 命題: 元のゲームにおいて必勝が存在 => 言い換えたゲームにおいても必勝が存在　が成立する時、その言い換えをしても必勝の人は変化しない
- ので、言い換えて良い

> 命題(勝利条件): ある条件Pであって、
> $$盤面がPを満たす \Rightarrow 操作の中でPを満たさない盤面にするものが存在$$
> $$盤面がPを満たさない \Rightarrow 任意の操作が、結果として盤面がPを満たす$$
> の2つを満たし、かつ終了条件が $P$ を満たす or 満たさないのどちらか一方の時、$P$ が勝敗の必要十分条件である。逆に、条件 $P$ が勝敗の必要十分を与えるならば上の2つを満たす。
- 部分的な先手勝ち条件やその予想が手に入った時、この命題に当てはめることでそれが必要十分か確認できる。逆に、この命題を満たさない時、それは条件として不適。
- 特に、盤面の判定を特徴量を用いたときにこの議論によって証明されることが多い
<br><br>

# 特徴量
- 2人ゲームの多くにおいて、「何かの偶奇」がゲームの勝敗を決定づける。

> 命題: 取る手に依存せずに変化する特徴量がある場合、その変化がわかり、かつ特徴量からゲームの勝敗判定ができればゲームの勝敗がわかる


- 勝敗を決める値には注目するべき && 何が決めるのか考えるべき
    - 多くのゲームは、勝敗が「ooの偶奇」で決まり、ではooをどうにかしようと言う考察になる
    - 「どちらが勝つか」という条件が「この特徴量は何か」と言う条件になって扱いやすい

> 命題: 1手ずつ行なっていくゲームでは、実行された手番の偶奇が勝敗を決める

> 系: 「1つずつ取っていく」ゲームの場合、最終的に取られた個数の偶奇が勝敗を決める

## 勝敗を決定する特徴量
> 命題: ゲームの勝敗が今の盤面のみに依存し、その盤面に至った操作には依存しない場合、次が成立する。  
> ゲームが終了した状態を任意に一つ固定する。この時、特徴量であって、終了した状態について定義できる物であってゲームの勝敗を決定づけるものが存在する。
- 特に、自明な条件(i.e. ゲームの定義そのまま) ではない、非自明な判定特徴量があると良い

> 系: 今にしか依存しないゲームは、終了盤面を固定した上で「この時どっちが勝ったか」の判定を考えることで、その判定に用いた情報量が勝敗を決定づける特徴量になる


## 偶奇系の定理
> 命題: nが奇数の時、任意の整数aに対し、 a(n-a)は偶数  

> 命題: nが偶数の時、a(n-a)は奇数・偶数ともに取る。特に、偶数 => 4の倍数
<br><br>

# 負け盤面とは・勝ち盤面とはの条件
- これが綺麗にわかったらもちろん解ける
- 条件を考える <- スパッと出せないなら、必要条件を積んでいく
  
> 命題: 次の1手が存在する盤面は終了状態では無い

> 命題: 終了盤面ならば特徴量が定まると言う時、その終了盤面だけで勝敗を判定できる

- > 命題: 隣合う要素が異なる数列において、要素の種類が2種類 ⇔ ababababab...型  

- > 命題: ababab..型の数列の長さが偶数 ⇔ 先頭と末尾が異なる

<br><br>

# 一致させる・させないゲーム
- 一致させる方が格段にむずい場合が多い
- != 0にする方の立場になった方が考えやすい
    - どうやれば0になるかは難しいが、どうやれば0にならないかは言えることが多い
- 「最後にずらす」ことが出来るなら、一致させない方が勝つ
    - 逆に、最後にずらせないような状況は極端なことが多い
    - もっと前に解析を進める or 帰納法で予想を示す
   
- 最後でなくても、操作を"ズラす"事を考えると良い

- 「一致していない」ということが、状況を固定する・操作ができる根拠になったり

<br><br>

# 石をとっていくゲーム
- ゲームの盤面に値を割り振る。先手必勝を1, 後手必勝を0とする。
> 命題: X -> X-2 にしても値が変化しない(i.e 先手必勝なら先手必勝 かつ 後手必勝なら後手必勝)　⇔ X-2 -> Xにしても値が変化しない

X-2で0(1) => Xで0(1)
(対偶)Xで1(0) => X-2で1(0)
- X-2 -> Xは示しやすい(必勝側が2を忘れて操作して、相手が取ったら取り返せば良い)
<br><br>


# Grundy数の考察


## 使うと決めた時
- Grandy数を、小さいNに対して列挙する
    - そのテーブルを見て、規則性を探す
    - 規則性が見つかったら
        - (1)理由 (2)自由度 (3)更に言える事　を考える
            - 理由...構造の理解、(2), (3)に繋がりやすくなる
    - あるいは：愚直計算の高速化
        - mexとなると集合を管理したい -> 差分更新と相性良い


## Grundy数への帰着
### 1回の操作による変化に着目
- 分裂すると大変
- 片方を消費するとかなら分裂しない
    - [例題](https://atcoder.jp/contests/arc013/tasks/arc013_3)



## Grundy数一致
ゲームA, Bについて g(A) = g(B) ⇔ AとBを連立したゲームが後手必勝(g = 0)
<br><br>

# xor = 0　

- xor と + の偶奇は一致

- a xor b = 0 ⇔  a = b

- a1 xor a2 xor a3 ... xor an について、sum ai の半分をを超える ai があったら、 xor != 0
- 他のxor = max
    - xorは+以下
        - プラスでさえ、右辺に届かない

<br><br>

# Strategy strealing
- 状態の遷移に包含関係がある時
    - 共通している遷移先に後手必勝がある: 先手はその遷移を選んで勝つ
    - 共通している遷移先が全て先手必勝: 
        - 先手は、必ずそういう遷移を選ばざるを得ない状況に遷移すると勝てる: そういう遷移があったら必ず選ぶ
        - 先手は、共通遷移先に後手必勝がある盤面に遷移すると負ける: そういう遷移があっても必ず選ばない

- いつ考える:
    - grundy数がどうしても無理・そもそも多山ではない


# 猿真似
> 命題: 最後に操作した方が勝ちを考える。対象かつ独立な盤面を2つ用意できて、かつ後攻の時、相手が片方の盤面で取った手をそのまま返すことで勝てる
- 他、「相手が操作したなら自分も操作できる」


# 勝敗がわかっている盤面に変更する
- 特に、何かの偶奇は簡単にずらせることが多い。よって、遷移先が勝ちならそうする。