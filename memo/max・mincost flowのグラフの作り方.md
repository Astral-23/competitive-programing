# max/mincost flowで解けるとは
- 要素について、「使って良い回数」が制限としてついている
- その中でのペアの最大個数(maxflow)やコストの最適化(mincostflow)

# グラフの設計-基礎
- (1)制限がある要素を頂点として、そこに s -> v の辺を張る。辺のcapを頂点の制約とする
    - 要素を表す頂点は1つの方がよい。わざわざ分ける必要があるか？
- (2) 要素間でも関係がある時は、二部グラフを作ると全ての頂点に制約を上手く課せられる
- 他、頂点の流量制限とかもできるが使った事ない


- 必要なこと: グラフの頂点数・辺の本数が少ない(1000以下ぐらいには収まっていて欲しい)
    - 頂点数は種類数に依存する。容量のサイズには依存しない（容量のサイズは辺の容量として表現される）
- いつ考える: 要素に容量が決まっていて、その中でその容量をうまく使って最適化せよという時
    - なんか貪欲がありそうと思ったらハマる事が多い
    - [例題](https://atcoder.jp/contests/abc263/tasks/abc263_g)
# 直接制約がかかっているもの以外の頂点を追加する場合
- 「2要素を選んで、どちらかにadd c」
    
    ![img](<images/upload_ed516772a59081ad87ca69c055d3e090.jpeg>)
    - このように、イベントにも頂点を割り振る/容量がついている時点でそれを頂点としてaddすると表現力が上がる

- どの行どの列も一つ以上選ぶやつ
    - 行、列で二部グラフ、両方辺に下限付きの辺をつける
    - 丁度一つなら、下限をつけなくても、フローの総和を見ることで確かめられる
    - [辺下限つけるライブラリ](https://astral-23.github.io/competitive-programing/Algorithm/maxflow_lowerbound.hpp)
    - https://atcoder.jp/contests/abc231/tasks/abc231_h


https://atcoder.jp/contests/abc285/tasks/abc285_g?lang=ja

- 多分難しい: 「この辺を通った時だけコスト2みたいなことして欲しい」
    - mcf?
    - 
## グラフ
- 要素の場所を選んで得点
    - 要素を表す頂点と、場所を表す頂点の2部グラフ
        - 貪欲じゃダメ？
        - 要素について、制約をかせる
            - "要素はki回までしか選ばれちゃダメ"
            - "要素はki回は選ばれないといけない"
    
- 辺について、端点の片方（まで）を選んで得点
    - 辺を表す頂点を作って、そいつに容量1(必要に応じて下限も)繋げて、それから端点を表す頂点2つに辺を貼る

- 集合からk個(まで）選んで得点
    - 集合を表す頂点、其奴に容量k(下限もいるかも)繋げて、それから端点


- 無向辺の容量下限（どちらかの向きに少なくとも) ... 無理そう

- sink/sourceはまとめる...一般に有効　属性をつけたいなら辺につけることで実現可能
    - 下限...容量下限付きの辺

- 変な問題https://drken1215.hatenablog.com/entry/2020/01/17/115300


- DAGの最小パス被覆をを二部グラフに落とすやつ
    - https://atcoder.jp/contests/abc354/editorial/10029

